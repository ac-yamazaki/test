machine:
  timezone: Asia/Tokyo
  php:
    version:7.1.3

dependencies:
  pre: 
    - phpenv versions
    - php -v
    - phpenv global 7.1.3
    - php -v
    - phpenv versions
    - phpunit --version

test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/phpunit
    - phpunit --log-junit $CIRCLE_TEST_REPORTS/phpunit/junit.xml SampleTest

deployment:
  deploy:
    branch: /m/
#    branch: /master/
    codedeploy:
      test-app:
        application_root: /
        region: ap-northeast-1
        revision_location:
          revision_type: S3
          s3_location:
            bucket: test-codedeploy-bucket2
            key_pattern: test/master/test-app-{BRANCH}-{SHORT_COMMIT}
        deployment_group: test-deploy-group
